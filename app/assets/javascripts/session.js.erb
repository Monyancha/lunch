<% timeout_duration = Devise.timeout_in.to_i * 1000 %>
$(function() {
  if($('html').data('authenticated-action') !== undefined) {
    setTimeout(check_session_status, <%=timeout_duration%>);
  };

  function check_session_status() {
    var status_url = $('html').data('session-status-path');
    $.get(status_url).always(function(data){
      if(!data.user_signed_in) {
        window.location = data.logged_out_path;
      } else {
        setTimeout(check_session_status, <%=(timeout_duration * 0.05).to_i%>);
      };
    });
  };

});