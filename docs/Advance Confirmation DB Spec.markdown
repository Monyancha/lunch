# Advance Confirmation DB Table Specification

The goal is to have an Oracle table (or view) that provides quick and efficent access to the list of advance confirmations generated for a specific trade, as well as the location where the confirmation document can be found.

## Advance Confirmation Documents

The actual confirmation documents should be PDFs, which are stored in __Amazon's S3__ storage service. This will provide fast, efficent, and distributed access to the confirmation documents, while still protecting their sensisitve nature. The files would only be readable by privilaged access keys (one of which would be used by the Member Portal). The files would only be writable by the operational processes (Calypso and/or some other secondary process) which generate them. The Member Portal would proxy downloads of the files to ensure that only the members in the borrowing institution with the appropriate roles would be able to download a given file.

## Advance Confirmation Table

The table design supports an advance having no confirmations, one confirmation, or multiple confirmations. It would need 5 columns:

  * __Confirmation Number__: The primary key of the table, and could be generated by an autoincrementing sequence or `IDENTITY` attribute.
  * __Member ID__: The FHLB ID of the insitution the confirmation is for. Data type should be `NUMBER`. This should be indexed.
  * __Advance Number__: The advance number that the confirmation is for. Data type should be `VARCHAR2`. This should be indexed.
  * __Confirmation Date__: The day the confirmation was generated. Data type should be `DATE`.
  * __File Location__: The fully qualified URI of the file in S3. Data type should be `VARCHAR2`.

The common query operations would be:

  * Given a list of advances, find all the confirmations. `SELECT * FROM ... WHERE MEMBER_ID = 7 AND ADVANCE_NUMBER IN('123456', '234578')`
  * Given a specific confirmation number, find the file location of the confirmation document. `SELECT FILE_LOCATION FROM ... WHERE MEMBER_ID = 7 AND ADVANCE_NUMBER = '123456' AND CONFIRMATION_NUMBER = 17`